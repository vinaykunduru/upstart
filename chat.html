<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Infinite Works Slider with Titles</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: #111;
        color: #fff;
        font-family: sans-serif;
      }
      section.hero {
        width: 100vw;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .grid {
        width: 100%;
      }
      .works-slider {
        overflow: hidden;
        width: 100%;
      }
      .works-container {
        display: flex;
        align-items: flex-start;
        will-change: transform;
      }
      .work-slide {
        flex: 0 0 auto;
        width: 240px;
        margin-right: 20px;
        background: #222;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
        cursor: pointer;
      }
      .work-slide img {
        width: 100%;
        height: 150px;
        object-fit: cover;
        display: block;
      }
      .work-slide h5 {
        margin: 0;
        padding: 10px;
        font-size: 16px;
        text-align: center;
        background: #000a;
        color: #fff;
        clip-path: inset(0 0 100% 0); /* hidden */
      }
    </style>
  </head>
  <body>
    <section class="hero">
      <div class="grid">
        <div class="works-slider">
          <div class="works-container" role="list">
            <!-- slides -->
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=1" />
              <h5>Project One</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=2" />
              <h5>Project Two</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=3" />
              <h5>Project Three</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=4" />
              <h5>Project Four</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=5" />
              <h5>Project Five</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=6" />
              <h5>Project Six</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=7" />
              <h5>Project Seven</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=8" />
              <h5>Project Eight</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=9" />
              <h5>Project Nine</h5>
            </div>
            <div class="work-slide" role="listitem">
              <img src="https://picsum.photos/400/200?random=10" />
              <h5>Project Ten</h5>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <script>
      class InfiniteHorizontalScroll {
        constructor(container) {
          this.container = container;
          this.items = Array.from(container.children);
          if (!this.items.length) return;
          this.scrollX = 0;
          this.smoothScrollX = 0;
          this.touchStartY = 0;
          this.touchDeltaY = 0;
          this.previousDeltaY = 0;
          this.cloneItems();
          this.calculateDimensions();
          this.init();
        }
        cloneItems() {
          const before = document.createDocumentFragment();
          const after = document.createDocumentFragment();
          this.items.forEach((item) => {
            before.appendChild(item.cloneNode(true));
            after.appendChild(item.cloneNode(true));
          });
          this.container.insertBefore(before, this.container.firstChild);
          this.container.appendChild(after);
        }
        calculateDimensions() {
          this.totalWidth = 0;
          Array.from(this.container.children).forEach((item) => {
            const itemWidth = item.getBoundingClientRect().width;
            const mr = parseFloat(getComputedStyle(item).marginRight);
            this.totalWidth += itemWidth + mr;
          });
          const originalWidth = this.totalWidth / 3;
          this.scrollX = originalWidth;
          this.smoothScrollX = originalWidth;
          this.container.style.transform = `translateX(${-this.scrollX}px)`;
        }
        init() {
          document.addEventListener("wheel", (e) => this.handleWheel(e), {
            passive: false,
          });
          document.addEventListener(
            "touchstart",
            (e) => this.handleTouchStart(e),
            { passive: true }
          );
          document.addEventListener(
            "touchmove",
            (e) => this.handleTouchMove(e),
            { passive: false }
          );
          document.addEventListener("touchend", () => this.handleTouchEnd());
          this.animate();
          window.addEventListener("resize", () => this.calculateDimensions());
        }
        handleWheel(e) {
          e.preventDefault();
          this.scrollX += e.deltaY * 1.5;
          this.handleInfiniteScroll();
        }
        handleTouchStart(e) {
          this.touchStartY = e.touches[0].clientY;
          this.touchDeltaY = 0;
          this.previousDeltaY = 0;
        }
        handleTouchMove(e) {
          e.preventDefault();
          const touchY = e.touches[0].clientY;
          this.touchDeltaY = touchY - this.touchStartY;
          const speed = 3;
          this.scrollX -= (this.touchDeltaY - this.previousDeltaY) * speed;
          this.previousDeltaY = this.touchDeltaY;
          this.handleInfiniteScroll();
        }
        handleTouchEnd() {
          this.touchDeltaY = 0;
          this.previousDeltaY = 0;
        }
        handleInfiniteScroll() {
          const originalWidth = this.totalWidth / 3;
          if (this.scrollX < 0) {
            this.scrollX += originalWidth;
            this.smoothScrollX += originalWidth;
          } else if (this.scrollX > this.totalWidth - originalWidth) {
            this.scrollX -= originalWidth;
            this.smoothScrollX -= originalWidth;
          }
        }
        animate() {
          this.smoothScrollX += (this.scrollX - this.smoothScrollX) * 0.06;
          this.container.style.transform = `translateX(${-this
            .smoothScrollX}px)`;
          requestAnimationFrame(() => this.animate());
        }
      }
      new InfiniteHorizontalScroll(document.querySelector(".works-container"));

      // Hover title animation
      document.querySelectorAll(".work-slide").forEach((slide) => {
        const title = slide.querySelector("h5");
        gsap.set(title, { clipPath: "inset(0 0 100% 0)" });
        slide.addEventListener("mouseenter", () => {
          gsap.to(title, {
            clipPath: "inset(0 0 0% 0)",
            duration: 0.6,
            ease: "power3.out",
          });
        });
        slide.addEventListener("mouseleave", () => {
          gsap.to(title, {
            clipPath: "inset(0 0 100% 0)",
            duration: 0.6,
            ease: "power3.in",
          });
        });
      });
    </script>
  </body>
</html>
